(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[499],{5695:(e,r,s)=>{"use strict";var a=s(8999);s.o(a,"useRouter")&&s.d(r,{useRouter:function(){return a.useRouter}})},5890:(e,r,s)=>{Promise.resolve().then(s.bind(s,8673))},8088:(e,r,s)=>{"use strict";s.d(r,{CartProvider:()=>i,_:()=>n});var a=s(5155),t=s(2115);let l=(0,t.createContext)(void 0);function i(e){let{children:r}=e,[s,i]=(0,t.useState)([]),[n,d]=(0,t.useState)(0),[c,o]=(0,t.useState)(0);(0,t.useEffect)(()=>{let e=localStorage.getItem("cart");if(e)try{let r=JSON.parse(e);i(r)}catch(e){console.error("Failed to parse cart from localStorage:",e)}},[]),(0,t.useEffect)(()=>{s.length>0&&localStorage.setItem("cart",JSON.stringify(s))},[s]),(0,t.useEffect)(()=>{d(s.reduce((e,r)=>e+r.quantity,0)),o(s.reduce((e,r)=>e+parseFloat(r.price.replace(/[^\d.]/g,""))*r.quantity,0))},[s]);let m=e=>{i(r=>r.filter(r=>r.id!==e))};return(0,a.jsx)(l.Provider,{value:{cartItems:s,addToCart:e=>{i(r=>r.find(r=>r.id===e.id)?r.map(r=>r.id===e.id?{...r,quantity:r.quantity+1}:r):[...r,{...e,quantity:1}])},removeFromCart:m,updateQuantity:(e,r)=>{if(r<=0){m(e);return}i(s=>s.map(s=>s.id===e?{...s,quantity:r}:s))},clearCart:()=>{i([]),localStorage.removeItem("cart")},totalItems:n,totalPrice:c},children:r})}function n(){let e=(0,t.useContext)(l);if(void 0===e)throw Error("useCart must be used within a CartProvider");return e}},8673:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>m});var a=s(5155),t=s(2115),l=s(2243),i=s(6766),n=s(6874),d=s.n(n),c=s(5695),o=s(8088);function m(){let e=(0,c.useRouter)(),{cartItems:r,totalPrice:s,clearCart:n}=(0,o._)(),[m,x]=(0,t.useState)("alipay"),[h,u]=(0,t.useState)(""),[p,f]=(0,t.useState)(!1),[g,j]=(0,t.useState)(!1),[b,v]=(0,t.useState)(!1),[y,N]=(0,t.useState)({name:"",phone:"",address:""});(0,t.useEffect)(()=>{u((()=>{let e=new Date().getTime(),r=Math.floor(1e3*Math.random());return"BH".concat(e).concat(r)})())},[]),(0,t.useEffect)(()=>{0!==r.length||b||e.push("/cart")},[r,e,b]);let w=e=>{let{name:r,value:s}=e.target;N(e=>({...e,[r]:s}))},k=e=>{x(e)};return b?(0,a.jsx)("div",{className:"pt-24 pb-16",children:(0,a.jsx)("div",{className:"container-custom",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto bg-white dark:bg-[#1a1a1a] rounded-lg shadow-md p-8 text-center",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-green-600 dark:text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"支付成功！"}),(0,a.jsxs)("p",{className:"text-[var(--foreground)]/70 mb-2",children:["您的订单 #",h," 已支付成功"]}),(0,a.jsx)("p",{className:"text-[var(--foreground)]/70 mb-8",children:"我们将尽快为您准备订单，感谢您的惠顾！"}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,a.jsx)(d(),{href:"/",className:"px-6 py-3 bg-[var(--secondary)]/20 hover:bg-[var(--secondary)]/40 rounded-md transition-colors duration-300",children:"返回首页"}),(0,a.jsx)(d(),{href:"/menu",className:"px-6 py-3 bg-[var(--primary)] text-white rounded-md hover:bg-[var(--primary-dark)] transition-colors duration-300",children:"继续购物"})]})]})})}):(0,a.jsxs)("div",{className:"pt-24 pb-16",children:[(0,a.jsx)("div",{className:"bg-[var(--primary)] text-white py-16",children:(0,a.jsxs)("div",{className:"container-custom text-center",children:[(0,a.jsx)(l.P.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-4xl md:text-5xl font-bold mb-4",children:"结算"}),(0,a.jsx)(l.P.div,{initial:{opacity:0,width:0},animate:{opacity:1,width:"80px"},transition:{duration:.5,delay:.2},className:"h-1 bg-white mx-auto mb-6"}),(0,a.jsx)(l.P.p,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.3},className:"max-w-2xl mx-auto text-white/90",children:"完成您的订单并进行支付"})]})}),(0,a.jsx)("div",{className:"container-custom mt-12",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:g?(0,a.jsxs)("div",{className:"bg-white dark:bg-[#1a1a1a] rounded-lg shadow-md p-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-6",children:"请扫码支付"}),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg mb-6",children:"alipay"===m?(0,a.jsx)("div",{className:"relative w-64 h-64",children:(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",className:"w-full h-full text-blue-500",children:[(0,a.jsx)("rect",{x:"0",y:"0",width:"100",height:"100",fill:"white"}),(0,a.jsx)("path",{d:"M10,10 L90,10 L90,90 L10,90 Z",fill:"none",stroke:"currentColor",strokeWidth:"5"}),(0,a.jsx)("path",{d:"M30,30 L70,30 L70,70 L30,70 Z",fill:"none",stroke:"currentColor",strokeWidth:"5"}),(0,a.jsx)("circle",{cx:"50",cy:"50",r:"10",fill:"currentColor"}),(0,a.jsx)("text",{x:"50",y:"95",textAnchor:"middle",fill:"currentColor",fontSize:"8",children:"支付宝"})]})})}):(0,a.jsx)("div",{className:"relative w-64 h-64",children:(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",className:"w-full h-full text-green-500",children:[(0,a.jsx)("rect",{x:"0",y:"0",width:"100",height:"100",fill:"white"}),(0,a.jsx)("path",{d:"M10,10 L90,10 L90,90 L10,90 Z",fill:"none",stroke:"currentColor",strokeWidth:"5"}),(0,a.jsx)("path",{d:"M25,25 L75,25 L75,75 L25,75 Z",fill:"none",stroke:"currentColor",strokeWidth:"5"}),(0,a.jsx)("path",{d:"M40,40 L60,40 L60,60 L40,60 Z",fill:"none",stroke:"currentColor",strokeWidth:"5"}),(0,a.jsx)("text",{x:"50",y:"95",textAnchor:"middle",fill:"currentColor",fontSize:"8",children:"微信支付"})]})})})}),(0,a.jsxs)("p",{className:"text-center mb-2",children:["请使用",(0,a.jsx)("span",{className:"font-semibold",children:"alipay"===m?"支付宝":"微信"}),"扫描二维码完成支付"]}),(0,a.jsxs)("p",{className:"text-[var(--foreground)]/70 text-sm mb-6",children:["订单号: ",h]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("button",{onClick:()=>j(!1),className:"px-6 py-2 border border-gray-300 dark:border-gray-700 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-300",children:"返回"}),(0,a.jsx)("button",{onClick:()=>{j(!1),v(!0),n()},className:"px-6 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors duration-300",children:"模拟支付完成"})]})]})]}):(0,a.jsxs)("div",{className:"bg-white dark:bg-[#1a1a1a] rounded-lg shadow-md p-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-6",children:"联系信息"}),(0,a.jsx)("form",{onSubmit:e=>{if(e.preventDefault(),!y.name||!y.phone){alert("请填写姓名和电话");return}f(!0),setTimeout(()=>{f(!1),j(!0)},1500)},children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium mb-2",children:["姓名 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",id:"name",name:"name",value:y.name,onChange:w,required:!0,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--primary)] dark:bg-[#2a2a2a]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"phone",className:"block text-sm font-medium mb-2",children:["电话 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"tel",id:"phone",name:"phone",value:y.phone,onChange:w,required:!0,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--primary)] dark:bg-[#2a2a2a]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium mb-2",children:"地址（可选）"}),(0,a.jsx)("input",{type:"text",id:"address",name:"address",value:y.address,onChange:w,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--primary)] dark:bg-[#2a2a2a]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-4",children:"支付方式"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)("div",{className:"border rounded-md p-4 cursor-pointer transition-all duration-300 ".concat("alipay"===m?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-700"),onClick:()=>k("alipay"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full border-2 border-blue-500 flex items-center justify-center mr-3",children:"alipay"===m&&(0,a.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full"})}),(0,a.jsx)("span",{className:"font-medium",children:"支付宝"})]})}),(0,a.jsx)("div",{className:"border rounded-md p-4 cursor-pointer transition-all duration-300 ".concat("wechat"===m?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-gray-300 dark:border-gray-700"),onClick:()=>k("wechat"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full border-2 border-green-500 flex items-center justify-center mr-3",children:"wechat"===m&&(0,a.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"})}),(0,a.jsx)("span",{className:"font-medium",children:"微信支付"})]})})]})]}),(0,a.jsx)("button",{type:"submit",disabled:p,className:"w-full py-3 rounded-md font-medium transition-colors duration-300 ".concat(p?"bg-gray-400 cursor-not-allowed":"bg-[var(--primary)] text-white hover:bg-[var(--primary-dark)]"),children:p?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"生成支付二维码..."]}):"生成支付二维码"})]})})]})}),(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-[#1a1a1a] rounded-lg shadow-md p-6 sticky top-24",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-6",children:"订单摘要"}),(0,a.jsx)("div",{className:"max-h-60 overflow-y-auto mb-6",children:r.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"relative h-12 w-12 rounded-md overflow-hidden flex-shrink-0",children:(0,a.jsx)(i.default,{src:e.image,alt:e.name,fill:!0,className:"object-cover"})}),(0,a.jsxs)("div",{className:"flex-grow",children:[(0,a.jsx)("p",{className:"font-medium text-sm",children:e.name}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("span",{className:"text-xs text-[var(--foreground)]/70",children:[e.quantity," x ",e.price]}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:["\xa5",(parseFloat(e.price.replace(/[^\d.]/g,""))*e.quantity).toFixed(2)]})]})]})]},e.id))}),(0,a.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-[var(--foreground)]/70",children:"商品总价"}),(0,a.jsxs)("span",{children:["\xa5",s.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-[var(--foreground)]/70",children:"配送费"}),(0,a.jsx)("span",{children:"\xa50.00"})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 flex justify-between font-semibold",children:[(0,a.jsx)("span",{children:"总计"}),(0,a.jsxs)("span",{className:"text-[var(--primary)]",children:["\xa5",s.toFixed(2)]})]})]}),(0,a.jsx)("div",{className:"bg-[var(--secondary)]/10 p-4 rounded-md",children:(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"订单号："}),h]})})]})})]})})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[243,766,874,441,684,358],()=>r(5890)),_N_E=e.O()}]);